import React, { useState } from "react";
import { IoChevronBackCircle } from "react-icons/io5";
import { useNavigate } from "react-router-dom";
import { FiX } from "react-icons/fi";

// داده‌های کامل نیازهای آموزشی بر اساس فایل PDF
const educationalNeeds = {
  "نیازهای آموزشی کلی بیماران در PICU": [
    "عدم آگاهی از قوانین بخش و روند درمان",
    "کمبود آگاهی والدین نسبت به اهمیت رعایت بهداشت دست و پیشگیری از انتقال عفونت",
    "کمبود آگاهی والدین درباره رعایت نکات ایمنی کودک و خطر سقوط از تخت",
    "عدم آگاهی خانواده نسبت به داروهای مصرفی کودک",
    "کمبود دانش والدین در زمینه مدیریت درد و آرامسازی کودک در حین بستری",
    "کمبود دانش والدین درباره تغذیه کودک در طول پروسه درمان",
    "عدم شناخت مشاور حقوق بیمار",
    "کمبود آگاهی والدین نسبت به علائم هشداردهنده مربوط به بیماری",
    "عدم آگاهی خانواده درباره نحوه مراقبت از لاین‌های وریدی و کانتزهایی مثل شالدون",
    "عدم آگاهی والدین از راهکارهای مدیریت استرس"
  ],

  "نیازهای آموزشی درباره تشنج": [
    "کمبود یا عدم آگاهی از اقدامات ایمنی هنگام تشنج",
    "عدم آگاهی درباره مصرف داروهای تشنج",
    "کمبود یا عدم آگاهی از عوارض داروها و نحوه گزارش آنها",
    "کمبود یا عدم آگاهی از پیگیری های منظم پزشکی و آزمایش ها",
    "کمبود آگاهی از علائم خطر بیماری تشنج",
    "کمبود یا عدم آگاهی از علائم اولیه هشدار تشنج (علائم اورا)"
  ],

  "نیازهای آموزشی در DKA (کتواسیدوز دیابتی)": [
    "کمبود یا عدم آگاهی از تعریف دیابت و DKA و اهمیت کنترل آن",
    "کمبود یا عدم آگاهی از روش صحیح تست قند خون",
    "کمبود یا عدم آگاهی از علائم هشداردهنده قند بالا و کتواسیدوز",
    "کمبود یا عدم آگاهی از انواع انسولین و نحوه تزریق صحیح",
    "کمبود یا عدم آگاهی از محاسبه دوز انسولین و زمان‌بندی تزریق‌ها",
    "کمبود یا عدم آگاهی از اصول تغذیه مناسب و محاسبه کربوهیدرات",
    "کمبود یا عدم آگاهی از زمان مناسب مراجعه فوری به پزشک یا بیمارستان",
    "کمبود یا عدم آگاهی از مراقبت‌های پوستی، بهداشت دهان و پیشگیری از عفونت‌ها",
    "کمبود یا عدم آگاهی از نقش فعالیت بدنی ایمن در کنترل قند خون",
    "عدم آگاهی از علائم افزایش و کاهش قند خون"
  ],

  "نیازهای آموزشی گاستروآنتریت": [
    "عدم آگاهی از ماهیت بیماری گاستروآنتریت، علت‌ها و سیر آن",
    "عدم آگاهی از نشانه‌ها و علائم خطر بیماری",
    "عدم آگاهی از علائم کم‌آبی بدن و نحوه پیشگیری از آن",
    "عدم آگاهی از روش صحیح مصرف مایعات و محلول ORS",
    "عدم آگاهی از رژیم غذایی مناسب در دوران بیماری",
    "عدم آگاهی از ضرورت ادامه تغذیه با شیر مادر",
    "عدم آگاهی از اصول بهداشت فردی (شستن دست‌ها، استفاده از وسایل شخصی جدا)",
    "عدم آگاهی از اصول بهداشت محیطی (ضدعفونی وسایل، دفع صحیح مدفوع و پوشک)",
    "عدم آگاهی از زمان مناسب مراجعه به پزشک یا بیمارستان",
    "عدم آگاهی از روش صحیح مصرف داروهای تجویز شده",
    "عدم آگاهی از روش‌های پیشگیری از انتقال بیماری به سایرین"
  ],

  "نیازهای آموزشی بیماران با پنومونی": [
    "کمبود یا عدم آگاهی درباره شناخت علائم بالینی پنومونی",
    "کمبود یا عدم آگاهی درباره علائم حیاتی و وضعیت تنفسی",
    "کمبود یا عدم آگاهی درباره شناسایی علائم تنگی نفس (شامل افزایش سرعت تنفس، کشیده شدن عضلات بین دنده‌ای، کبودی لب‌ها یا ناخن‌ها، صدای خس‌خس هنگام تنفس، استفاده از عضلات کمکی برای تنفس)",
    "کمبود یا عدم آگاهی درباره مصرف صحیح داروها و رعایت دوره درمانی",
    "کمبود یا عدم آگاهی درباره مراقبت تنفسی و تمرینات تنفسی و ابزارهای کمک تنفسی",
    "کمبود یا عدم آگاهی درباره مدیریت درد و کنترل درد",
    "کمبود یا عدم آگاهی درباره تغذیه و مایعات جهت حمایت از وضعیت بالینی",
    "کمبود یا عدم آگاهی درباره پیشگیری از انتقال عفونت و رعایت بهداشت محیط",
    "کمبود یا عدم آگاهی درباره شناسایی علائم خطر و اقدامات اضطراری",
    "کمبود یا عدم آگاهی درباره آموزش بازتوانی و بازگشت تدریجی به فعالیت‌ها"
  ],

  "نیازهای آموزشی بیماران با ESRD (نارسایی کلیوی مرحله نهایی)": [
    "کمبود آگاهی در مورد بیماری کلیوی خود",
    "کمبود آگاهی درباره رژیم غذایی مناسب",
    "عدم آگاهی از مصرف صحیح داروها",
    "کمبود اطلاعات در مورد مراقبت از دسترسی عروقی در محل دیالیز",
    "عدم آگاهی از علائم هشداردهنده اورژانسی تنفسی (کبودی لب ها، خستگی شدید و تنگی نفس و ...)",
    "کمبود آگاهی در مورد علائم تنگی نفس و اختلال تنفسی",
    "عدم آگاهی از تکنیک های تنفس عمیق و سرفه و استفاده صحیح از دستگاههای کمک تنفسی مثل نبولایزر",
    "کمبود آگاهی درباره محدودیت‌ها و فعالیت‌های مناسب روزمره",
    "عدم آگاهی از اهمیت حمایت روانی و مدیریت اضطراب",
    "کمبود اطلاعات درباره فرآیند دیالیز",
    "عدم آگاهی از پایبندی به برنامه درمانی و رژیم غذایی"
  ],

  "نیازهای آموزشی بیماران با غرق شدگی": [
    "عدم آگاهی یا کمبود آگاهی نسبت به ماهیت غرق‌شدگی و عوارض احتمالی آن (آسیب مغزی ناشی از هیپوکسی، عوارض ریوی، عفونت)",
    "عدم آگاهی یا کمبود آگاهی در زمینه علائم هشدار هنگام بستری (تنگی نفس، کبودی، کاهش سطح هوشیاری، تشنج)",
    "عدم آگاهی یا کمبود آگاهی درباره مراقبت‌های تنفسی (اکسیژن تراپی، ساکشن در صورت نیاز، استفاده از دستگاه کمک‌تنفسی)",
    "عدم آگاهی یا کمبود آگاهی در مورد تغذیه و محدودیت فعالیت در دوران بستری",
    "عدم آگاهی یا کمبود آگاهی نسبت به داروهای مصرفی در بیمارستان (علت تجویز، زمان مصرف، عوارض احتمالی)",
    "عدم آگاهی یا کمبود آگاهی در مورد پیگیری‌های لازم بعد از ترخیص (ویزیت پزشک، بررسی وضعیت ریوی و عصبی)",
    "عدم آگاهی یا کمبود آگاهی در زمینه حمایت روانی عاطفی از کودک (کمک به کاهش اضطراب ناشی از بستری و ترس از محیط بیمارستان)",
    "عدم آگاهی یا کمبود آگاهی والدین نسبت به آموزش مهارت‌های احیای قلبی-ریوی پایه (CPR) برای مواجهه با شرایط مشابه در آینده",
    "عدم آگاهی یا کمبود آگاهی در مورد اقدامات پیشگیرانه برای جلوگیری از تکرار حادثه (نظارت مداوم، ایمن‌سازی محیط‌های آبی، استفاده از تجهیزات ایمنی)",
    "عدم آگاهی از علائم هشداردهنده عوارض عصبی یا تنفسی (خواب آلودگی غیر معمول، تشنج و تنگی نفس)",
    "عدم آگاهی از اهمیت تغییر وضعیت مناسب بیمار و جلوگیری از زخم بستر"
  ],

  "نیازهای آموزشی بیماران با تروما به سر": [
    "عدم آگاهی یا کمبود آگاهی والدین نسبت به ماهیت تروما به سر و روند بهبودی",
    "عدم آگاهی یا کمبود آگاهی در ارتباط با مراقبت های تنفسی (اهمیت لوله تراشه یا تراکئوستومی، ساکشن، اکسیژن تراپی)",
    "عدم آگاهی یا کمبود آگاهی نسبت به داروها و نحوه صحیح مصرف آن‌ها (آموزش دوز، زمان‌بندی و عوارض جانبی)",
    "عدم آگاهی یا کمبود آگاهی نسبت به تغذیه مناسب پس از تروما به سر (رژیم غذایی سبک، مصرف مایعات کافی و اجتناب از غذاهای سنگین)",
    "عدم آگاهی یا کمبود آگاهی نسبت به علائم هشدار (تهوع مداوم، خواب آلودگی شدید، تشنج، تغییر سطح هوشیاری)",
    "عدم آگاهی یا کمبود آگاهی در زمینه استراحت و محدودیت فعالیت",
    "عدم آگاهی یا کمبود آگاهی نسبت به مراقبت‌های روانی – عاطفی کودک",
    "عدم آگاهی یا کمبود آگاهی در زمینه پیگیری پزشکی و زمان‌های مراجعه مجدد",
    "عدم آگاهی یا کمبود آگاهی نسبت به روش‌های پیشگیری از آسیب مجدد (آموزش درباره استفاده از کلاه ایمنی، صندلی ایمنی کودک، کمربند ایمنی و ایمن‌سازی محیط خانه و مدرسه)"
  ],

  "نیازهای آموزشی در بیماران با کانسر خون": [
    "عدم آگاهی یا کمبود آگاهی والدین/کودک نسبت به ماهیت بیماری و روند درمان (شیمی‌درمانی، رادیوتراپی، پیوند مغز استخوان)",
    "عدم آگاهی یا کمبود آگاهی در زمینه عوارض شایع درمان و شیمی درمانی (ریزش مو، تهوع، استفراغ، زخم‌های دهانی، ضعف ایمنی)",
    "عدم آگاهی یا کمبود آگاهی نسبت به علائم هشداردهنده عفونت (تب، لرز، تعریق، زخم دهان یا پوست) و زمان مراجعه فوری به پزشک",
    "عدم آگاهی یا کمبود آگاهی در مورد پیشگیری از عفونت (رعایت بهداشت دست، پرهیز از تماس با افراد بیمار، مصرف غذای سالم و پخته)",
    "عدم آگاهی یا کمبود آگاهی نسبت به خطر خونریزی و اقدامات احتیاطی (اجتناب از ضربه، مراقبت از دندان‌ها، پرهیز از مصرف داروهای ضدانعقاد بدون تجویز)",
    "عدم آگاهی یا کمبود آگاهی نسبت به علائم هشدار تنفس (تنگی نفس، سرفه مداوم، خس خس سینه و کبودی لب‌ها)",
    "عدم آگاهی یا کمبود آگاهی در مورد تجهیزات حمایتی تنفسی (اکسیژن تراپی، نبولایزر)",
    "عدم آگاهی یا کمبود آگاهی در زمینه تغذیه مناسب (رژیم پرکالری و پرپروتئین، مصرف مایعات کافی، اجتناب از غذاهای آلوده یا خام)",
    "عدم آگاهی یا کمبود آگاهی در خصوص مراقبت از دهان و دندان (شست‌وشوی ملایم دهان، استفاده از دهان‌شویه مناسب، پرهیز از مسواک سخت)",
    "عدم آگاهی یا کمبود آگاهی در مدیریت خستگی و ضعف (تنظیم فعالیت‌ها، استراحت کافی، خواب منظم)",
    "عدم آگاهی یا کمبود آگاهی نسبت به اهمیت پایبندی به داروها و پیگیری منظم جلسات درمانی",
    "عدم آگاهی یا کمبود آگاهی در زمینه حمایت روانی – عاطفی از کودک (کمک به پذیرش تغییر ظاهر، مدیریت اضطراب و افسردگی)",
    "عدم آگاهی یا کمبود آگاهی درباره روش‌های پیشگیری از اختلال رشد و تکامل (انجام فعالیت‌های مناسب سن در حد توان کودک، بازی‌های سبک و آموزشی)"
  ]
};

export default function EducationalNeeds() {
  const navigator = useNavigate();
  const [searchTerm, setSearchTerm] = useState("");
  const [selectedCategory, setSelectedCategory] = useState(null);

  // فیلتر کردن دسته‌بندی‌ها بر اساس جستجو
  const filteredCategories = Object.keys(educationalNeeds).filter((category) =>
    category.toLowerCase().includes(searchTerm.toLowerCase().trim())
  );

  return (
    <div className="min-h-screen flex flex-col items-center justify-start p-4 md:p-8 bg-gradient-to-br from-blue-50 to-cyan-50 relative">
      
      {/* دکمه بازگشت */}
      <IoChevronBackCircle 
        onClick={() => navigator(-1)} 
        className="absolute top-4 left-4 text-3xl text-blue-600 cursor-pointer hover:scale-105 transition-transform hover:text-blue-700 z-10" 
      />

      {/* عنوان صفحه */}
      <div className="text-center mb-6 md:mb-8 mt-4">
        <h1 className="text-2xl md:text-3xl font-bold text-gray-800 mb-2">نیازهای آموزشی بیماران PICU</h1>
        <p className="text-gray-600 text-sm md:text-base">بر اساس دسته‌بندی بیماری‌های مختلف</p>
      </div>

      {/* جستجو */}
      <div className="w-full max-w-4xl mb-6 md:mb-8">
        <input 
          type="text" 
          placeholder="جستجوی بیماری یا نیاز آموزشی (مثال: دیابت، تشنج، پنومونی)..." 
          value={searchTerm}
          onChange={(e) => setSearchTerm(e.target.value)}
          className="w-full px-4 py-3 border border-gray-300 rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent text-base"
        />
      </div>

      {/* لیست دسته‌بندی‌ها */}
      <div className="w-full max-w-6xl">
        {(searchTerm.trim() ? filteredCategories : Object.keys(educationalNeeds)).length > 0 ? (
          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6">
            {(searchTerm.trim() ? filteredCategories : Object.keys(educationalNeeds)).map((category) => (
              <div 
                key={category}
                className="p-4 border border-gray-200 rounded-xl bg-white shadow-sm hover:bg-blue-50 cursor-pointer transition-all duration-200 hover:shadow-md hover:border-blue-200 h-full flex flex-col"
                onClick={() => setSelectedCategory(category)}
              >
                <div className="flex items-center justify-between mb-3">
                  <h3 className="font-bold text-gray-800 text-base md:text-lg leading-tight">
                    {category.replace("نیازهای آموزشی ", "").replace("در بیماران با ", "").replace("درباره ", "")}
                  </h3>
                  <span className="text-xs md:text-sm text-blue-600 bg-blue-100 px-2 py-1 rounded-full whitespace-nowrap">
                    {educationalNeeds[category].length} نیاز
                  </span>
                </div>
                <div className="flex-1">
                  <p className="text-gray-600 text-xs md:text-sm line-clamp-3 leading-relaxed">
                    {educationalNeeds[category][0]}
                  </p>
                </div>
                <div className="mt-3 pt-3 border-t border-gray-100">
                  <span className="text-blue-600 text-xs md:text-sm font-medium">مشاهده جزئیات →</span>
                </div>
              </div>
            ))}
          </div>
        ) : (
          <div className="text-center py-12">
            <div className="text-gray-500 text-lg mb-4">❌ موردی یافت نشد</div>
            <button 
              onClick={() => setSearchTerm("")}
              className="text-blue-600 hover:text-blue-800 font-medium"
            >
              پاک کردن جستجو و نمایش همه موارد
            </button>
          </div>
        )}
      </div>

      {/* مودال نمایش جزئیات */}
      {selectedCategory && (
        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
          <div className="bg-white rounded-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col">
            {/* هدر مودال */}
            <div className="flex items-center justify-between p-6 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-cyan-50">
              <div>
                <h2 className="text-xl md:text-2xl font-bold text-gray-800">{selectedCategory}</h2>
                <p className="text-gray-600 text-sm mt-1">تعداد نیازهای آموزشی: {educationalNeeds[selectedCategory].length}</p>
              </div>
              <button 
                onClick={() => setSelectedCategory(null)}
                className="p-2 hover:bg-gray-200 rounded-full transition-colors"
              >
                <FiX size={24} className="text-gray-600" />
              </button>
            </div>

            {/* لیست نیازها */}
            <div className="overflow-y-auto flex-1 p-6">
              {/* تغییر اصلی اینجا است - حذف list-decimal و نمایش دستی شماره‌ها */}
              <div className="space-y-4">
                {educationalNeeds[selectedCategory].map((need, index) => (
                  <div key={index} className="flex items-start gap-3 text-gray-700 leading-7 text-base md:text-lg pb-3 border-b border-gray-100 last:border-b-0">
                    <span className="font-medium text-blue-700 bg-blue-50 px-2 py-1 rounded-full text-sm min-w-[2rem] text-center flex-shrink-0">
                      {index + 1}
                    </span>
                    <span className="flex-1">{need}</span>
                  </div>
                ))}
              </div>
            </div>
            {/* فوتر مودال */}
            <div className="p-4 border-t border-gray-200 bg-gray-50">
              <div className="flex gap-3">
                <button 
                  onClick={() => setSelectedCategory(null)}
                  className="flex-1 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium"
                >
                  بستن
                </button>
                <button 
                  onClick={() => window.print()}
                  className="px-6 py-3 border border-gray-300 rounded-lg hover:bg-gray-100 transition-colors font-medium"
                >
                  چاپ
                </button>
              </div>
            </div>
          </div>
        </div>
      )}

      {/* پیام وقتی جستجو نتیجه ندارد */}
      {searchTerm.trim() && filteredCategories.length === 0 && (
        <div className="fixed bottom-4 left-1/2 transform -translate-x-1/2 bg-orange-100 border border-orange-300 text-orange-800 px-4 py-3 rounded-lg shadow-lg">
          هیچ بیماری با عبارت "{searchTerm}" یافت نشد
        </div>
      )}
    </div>
  );
}